# Day 2 of CyberSecurity

--> Encapsulation :- The "Wrapping" of Data

Encapsulation is a fundamental concept in networking where data is wrapped with additional information (headers and sometimes footers) at each layer of the OSI model as it travels down the stack from the application to the physical layer.

Why is it needed?

Modularity: Each layer only needs to worry about its own specific functions.
Information Hiding: Details of one layer are hidden from others.
Protocol Independence: Different protocols can operate at different layers without affecting others.

How it Works (The Journey of a Web Page Request)

Imagine you type "google.com" into your web browser.

1. Application Layer (Layer 7):
   - Data: Your HTTP request ("GET / HTTP/1.1 Host: google.com").
   - Encapsulation: The browser (application) hands this data to the next layer.

2. Transport Layer (Layer 4):
   - Data: The HTTP request.
   - Encapsulation: TCP (Transmission Control Protocol) adds a TCP Header. This header includes source and destination port numbers (e.g., your browser uses a random high port, Google's web server uses port 80 or 443), sequence numbers, and acknowledgment numbers for reliable delivery.
   - Result: A "TCP Segment" (or UDP Datagram if using UDP).

3. Network Layer (Layer 3):
   - Data: The TCP Segment.
   - Encapsulation: IP (Internet Protocol) adds an IP Header. This header includes the source IP address (your computer's IP) and the destination IP address (Google's server IP). It also includes information for routing.
   - Result: An "IP Packet."

4. Data Link Layer (Layer 2):
   - Data: The IP Packet.
   - Encapsulation: The Data Link layer (e.g., Ethernet) adds an Ethernet Header and an Ethernet Trailer (or "Frame Check Sequence" - FCS). The header includes the source MAC address (your network card's MAC) and the destination MAC address (the MAC address of your router's interface). The trailer contains error-checking information.
   - Result: An "Ethernet Frame."

5. Physical Layer (Layer 1):
   - Data: The Ethernet Frame.
   - Encapsulation: The entire frame is converted into electrical signals, light pulses, or radio waves

======================================================================================================================================================

--> Decapsulation :- The "Unwrapping" of DataDecapsulation is the reverse process of encapsulation. As data travels up the OSI model layers at the receiving end, each layer removes the header (and sometimes footer) added by its corresponding layer on the sending side. This process reveals the original data to the application.

Why is it needed?

Data Extraction: To progressively reveal the original application data.
Error Checking: Each layer can verify the integrity of its specific header and payload.
Protocol Processing: Allows each layer to process the information relevant to its function.

How it Works (The Journey of a Web Page Response)

Imagine Google's server sending the requested web page back to your browser.

1. Physical Layer (Layer 1):
   - Data: Electrical signals, light pulses, or radio waves.
   - Decapsulation: The physical layer receives these signals and converts them back into a raw Ethernet Frame.

2. Data Link Layer (Layer 2):
   - Data: The Ethernet Frame.
   - Decapsulation: The Data Link layer removes the Ethernet Header and Trailer. It checks the FCS for errors and verifies the destination MAC address. If the MAC address matches the device's, it passes the IP Packet up.
   - Result: An "IP Packet."

3. Network Layer (Layer 3):
   - Data: The IP Packet.
   - Decapsulation: The Network layer removes the IP Header. It checks the destination IP address to ensure the packet is for this host and processes routing information if necessary. It then passes the TCP Segment up.
   - Result: A "TCP Segment."

4. Transport Layer (Layer 4):
   - Data: The TCP Segment.
   - Decapsulation: The Transport layer removes the TCP Header. It uses the port numbers to deliver the data to the correct application process (e.g., your web browser). It also handles reassembly of segments and error recovery if needed.
   - Result: The original HTTP response data.

5. Application Layer (Layer 7):
   - Data: The HTTP response data (e.g., the HTML, CSS, JavaScript for google.com).
   - Decapsulation: The application (your web browser) receives the data and renders the web page for you to see.

======================================================================================================================================================

--> Cable Types :-There are several types of cables used in networking, each with different characteristics and applications.

1. Twisted Pair Cable:
   - Description: Consists of pairs of insulated copper wires twisted together. The twisting helps reduce electromagnetic interference (EMI) from external sources and crosstalk between adjacent pairs.
   - Types:
     - Unshielded Twisted Pair (UTP): Most common type, used in Ethernet networks. It's inexpensive and easy to install.
     - Shielded Twisted Pair (STP): Has an additional metallic shield around the twisted pairs to further reduce EMI. More expensive and harder to install than UTP.
   - Categories (for UTP):
     - Cat3: Used for voice communication (telephones).
     - Cat5/5e: Common for 100 Mbps Ethernet. Cat5e supports Gigabit Ethernet.
     - Cat6/6a: Supports Gigabit Ethernet and 10 Gigabit Ethernet over shorter distances. Cat6a offers better performance over longer distances.
     - Cat7/7a: Supports 10 Gigabit Ethernet and beyond, with individual shielding for each pair.
   - Connectors: RJ-45 (for Ethernet), RJ-11 (for telephones).
   - Applications: Local Area Networks (LANs), telephone lines.

2. Coaxial Cable:
   - Description: Consists of a central copper conductor, an insulating layer, a metallic shield, and an outer insulating jacket.
   - Types:
     - Thicknet (10BASE5): Older, thicker cable, used for early Ethernet.
     - Thinnet (10BASE2): Thinner, more flexible, also used for early Ethernet.
     - RG-6: Commonly used for cable television and internet.
     - RG-59: Used for CCTV and older video applications.
   - Connectors: BNC, F-type.
   - Applications: Cable TV, internet connections (cable modems), older Ethernet networks, CCTV.

3. Fiber Optic Cable:
   - Description: Transmits data using light pulses through glass or plastic strands. It's immune to electromagnetic interference and can transmit data over very long distances at high speeds.
   - Types:
     - Single-Mode Fiber (SMF): Has a very small core, allowing a single path for light. Used for long-distance, high-bandwidth applications (e.g., intercontinental communication,

======================================================================================================================================================

--> Transceivers :-multimode fiber).
     - Multi-Mode Fiber (MMF): Has a larger core, allowing multiple paths for light. Used for shorter distances within buildings or campuses.
   - Connectors: SC, ST, LC, MTRJ.
   - Applications: High-speed data networks, long-haul telecommunications, data centers.

--> Transceivers :- Devices that send and receive data. They convert electrical signals into optical signals (for fiber) or vice versa, or prepare electrical signals for transmission over copper.

1. SFP (Small Form-Factor Pluggable):
   - Description: A compact, hot-pluggable transceiver used for both telecommunication and data communications applications. It interfaces a network device mother board (for a router, switch, media converter or similar device) to a fiber optic or copper networking cable.
   - Types: Available in various types for different speeds and distances (e.g., 1000BASE-SX for multimode fiber, 1000BASE-LX for single-mode fiber).
   - Applications: Gigabit Ethernet, Fibre Channel.

2. SFP+ (Small Form-Factor Pluggable Plus):
   - Description: An enhanced version of the SFP that supports data rates up to 10 Gbit/s. It's the most popular 10 Gigabit Ethernet fiber module.
   - Applications: 10 Gigabit Ethernet, Fibre Channel.

3. QSFP (Quad Small Form-Factor Pluggable):
   - Description: A compact, hot-pluggable transceiver used for 40 Gigabit Ethernet and 100 Gigabit Ethernet applications. It integrates 4 transmit and 4 receive channels.
   - Types: QSFP+, QSFP28 (for 100G).
   - Applications: Data centers, high-performance computing networks.

4. GBIC (Gigabit Interface Converter):
   - Description: An older, larger form-factor transceiver that was replaced by SFP. It also converts electrical signals to optical signals and vice versa.
   - Applications: Older Gigabit Ethernet equipment.

======================================================================================================================================================

--> Cabling Standards :-Cabling standards are crucial for ensuring interoperability, performance, and reliability in network installations. They define how cables should be manufactured, installed, and tested.

1. TIA/EIA-568 (Commercial Building Telecommunications Cabling Standard):
   - Description: This is a set of telecommunications standards from the Telecommunications Industry Association (TIA) and Electronic Industries Alliance (EIA) that specifies commercial building cabling for telecommunications products and services. It defines structured cabling systems.
   - Key Aspects:
     - Defines cable types (UTP, STP, fiber optic) and their performance categories (Cat5e, Cat6, Cat6a, etc.).
     - Specifies connector types (RJ-45).
     - Dictates wiring schemes for RJ-45 connectors (T568A and T568B).
     - Sets maximum cable lengths for different applications.
     - Covers installation practices, grounding, and bonding.
   - T568A vs. T568B: These are two color codes used for wiring RJ-45 connectors. Both are electrically identical, but it's important to use the same standard throughout an installation.
     - T568A: Green/White, Green, Orange/White, Blue, Blue/White, Orange, Brown/White, Brown.
     - T568B: Orange/White, Orange, Green/White, Blue, Blue/White, Green, Brown/White, Brown.
   - Applications: Standard for virtually all modern Ethernet installations in commercial and residential buildings.

2. ISO/IEC 11801 (Information technology â€” Generic cabling for customer premises):
   - Description: An international standard that specifies general-purpose telecommunication cabling systems (structured cabling) for use within commercial buildings. It is very similar to the TIA/EIA-568 standard but is used internationally.
   - Key Aspects:
     - Defines classes of cabling (e.g., Class D for Cat5e, Class E for Cat6, Class EA for Cat6a) based on performance.
     - Specifies requirements for various cabling components (cables, connectors, patch panels).
     - Covers installation and testing procedures.
   - Applications: Widely adopted in Europe and other parts of the world for structured cabling.

3. IEEE 802.3 (Ethernet Standard):
   -Description: A collection of standards that define the physical and data link layers of wired Ethernet. It specifies various aspects of Ethernet technology, including frame formats, cabling, and signaling.
   - Key Aspects:
     - Defines different Ethernet speeds (e.g., 10BASE-T for 10 Mbps, 100BASE-TX for 100 Mbps, 1000BASE-T for Gigabit Ethernet, 10GBASE-T for 10 Gigabit Ethernet).
     - Specifies the types of cables and connectors to be used for each speed.
     - Covers collision detection and avoidance mechanisms (CSMA/CD for older Ethernet, full-duplex for modern switched Ethernet).
   - Applications: The foundational standard for virtually all wired Local Area Networks (LANs) today.

======================================================================================================================================================

--> Ethernet Frame :-The Ethernet Frame is the fundamental unit of data transmission at the Data Link Layer (Layer 2) in Ethernet networks. It encapsulates the IP Packet (and its encapsulated data) for transmission over the physical medium.

An Ethernet Frame typically consists of the following fields:

1.  **Preamble (7 bytes):**
    *   **Description:** A sequence of alternating 1s and 0s (10101010...) used for synchronization between the transmitting and receiving network interface cards (NICs). It signals the start of a new frame.

2.  **Start Frame Delimiter (SFD) (1 byte):**
    *   **Description:** A specific sequence (10101011) that marks the end of the Preamble and indicates the actual start of the Ethernet frame.

3.  **Destination MAC Address (6 bytes):**
    *   **Description:** The MAC address of the receiving device. This can be a unicast (single device), multicast (group of devices), or broadcast (all devices on the segment) address.

4.  **Source MAC Address (6 bytes):**
    *   **Description:** The MAC address of the sending device.

5.  **EtherType / Length (2 bytes):**
    *   **Description:** This field serves a dual purpose:
        *   **EtherType:** If its value is greater than or equal to 1536 (0x0600 hexadecimal), it indicates the protocol encapsulated in the frame's data field (e.g., 0x0800 for IPv4, 0x0806 for ARP, 0x86DD for IPv6).
        *   **Length:** If its value is less than 1536, it indicates the length of the data field in bytes. This is less common in modern Ethernet (IEEE 802.3) which typically uses EtherType.

6.  **Data (46-1500 bytes):**
    *   **Description:** This is the actual payload of the frame, which typically contains the IP Packet (including the TCP/UDP segment and application data).
    *   **Minimum Size:** Ethernet frames have a minimum data size of 46 bytes. If the encapsulated data is smaller than 46 bytes, padding bytes are added to meet this minimum.
    *

7. CRC:   **Description:** Cyclic Redundancy Check (4 bytes). This is an error-detecting code added to the end of the frame. The receiving NIC performs the same calculation; if the results don't match, it indicates data corruption during transmission, and the frame is usually discarded.

======================================================================================================================================================

--> Switching Logic (smart traffic Control) :-Switching logic refers to how network switches make decisions about forwarding Ethernet frames between connected devices. Switches operate at Layer 2 (Data Link Layer) of the OSI model and use MAC addresses to direct traffic.

The primary goal of a switch is to efficiently forward frames only to the port where the destination device is connected, rather than broadcasting them to all ports (like a hub would). This reduces network congestion and improves security.

Key Concepts in Switching Logic:

1.  **MAC Address Table (CAM Table - Content Addressable Memory):**
    *   **Description:** This is the core component of a switch's intelligence. It's a table stored in the switch's memory that maps MAC addresses to specific switch ports.
    *   **Learning Process:** When a switch receives a frame, it inspects the **Source MAC Address** of the frame. If this MAC address is not already in its MAC address table, the switch adds an entry: `[Source MAC Address] -> [Port on which the frame was received]`. This is called "MAC address learning."
    *   **Aging:** Entries in the MAC address table have an aging timer. If a MAC address is not seen again within a certain period (e.g., 5 minutes), its entry is removed from the table. This prevents the table from becoming stale with devices that are no longer connected.

2.  **Frame Forwarding Decision Process:**
    When a switch receives an Ethernet frame, it performs the following steps:

    *   **Step 1: Learn Source MAC Address:** It examines the **Source MAC Address** of the incoming frame.
        *   If the MAC address is unknown, it adds it to the MAC address table along with the port it came in on.
        *   If the MAC address is already in the table but associated with a different port, the switch updates the entry (this can happen if a device moves to a different port).
        *   If the MAC address is already in the table and associated with the same port, the switch simply refreshes the aging timer for that entry.

    *   **Step 2: Determine Destination Port:** It then examines the **Destination MAC Address** of the incoming frame.

        *   **Unicast Destination:**
            *   **Known Unicast:** The switch looks up the Destination MAC Address in its MAC address table.
                *   If the destination MAC address is found and is associated withe *same port* as the incoming frame, the switch will **filter** (drop) the frame. This prevents unnecessary traffic on the segment.
                *   If the destination MAC address is found and is associated with a *different port* than the incoming frame, the switch will **forward** the frame out only that specific destination port.
            *   **Unknown Unicast:** If the destination MAC address is *not found* in the MAC address table, the switch will **flood** the frame out of all ports *except* the port on which it was received. This is done in an attempt to find the destination device, and once the destination replies, the switch will learn its MAC address.

        *   **Broadcast Destination (FF:FF:FF:FF:FF:FF):** The switch will always **flood** the frame out of all ports *except* the port on which it was received. Broadcasts are intended for all devices on the local network segment.

        *   **Multicast Destination:** The switch will typically **flood** the frame out of all ports *except* the port on which it was received, similar to a broadcast, unless it is configured for IGMP snooping (a feature that allows the switch to learn which ports have multicast listeners and only forward multicast traffic to those specific ports).

3.  **Collision Domains:** Each port on a switch creates its own collision domain. This means that devices connected to different switch ports can transmit simultaneously without collisions, significantly improving network performance compared to hubs.

======================================================================================================================================================

--> Spannning tree Protocol :-
Spanning Tree Protocol (STP) is a network protocol that ensures a loop-free logical topology for Ethernet networks. Loops in a network can cause broadcast storms, MAC address table instability, and multiple frame copies, leading to network degradation or failure. STP prevents these issues by strategically blocking redundant paths.

Why is it needed?

Redundancy: Network designers often create redundant paths to ensure high availability. If one link fails, another can take over.
Loop Prevention: Without STP, these redundant paths would create loops, which are detrimental to Ethernet networks.

How it Works:

1.  **Bridge Protocol Data Units (BPDUs):** Switches running STP exchange special frames called BPDUs. These BPDUs contain information about the switch's Bridge ID (BID), root path cost, and port ID.

2.  **Root Bridge Election:**
    *   All switches in a network participate in electing a single **Root Bridge**.
    *   The switch with the lowest Bridge ID becomes the Root Bridge. The Bridge ID is a combination of a configurable priority value (default 32768) and the switch's MAC address. A lower priority value is preferred, and if priorities are equal, the lowest MAC address wins.
    *   The Root Bridge is the logical center of the STP topology and is responsible for sending out BPDUs to synchronize the network.

3.  **Root Port Election (on Non-Root Bridges):**
    *   Every non-Root Bridge switch determines its **Root Port**.
    *   The Root Port is the port that has the lowest cost path to the Root Bridge.
    *   Cost is typically determined by link speed (e.g., 10 Mbps = 100, 100 Mbps = 19, 1 Gbps = 4, 10 Gbps = 2).
    *   If multiple paths have the same cost, other tie-breakers are used (e.g., lowest sender Bridge ID, lowest sender Port ID).

4.  **Designated Port Election (on Each Segment):**
    *   For each network segment (link between two switches), a **Designated Port** is elected.
    *   The Designated Port is the port on that segment that has the lowest cost path to the Root Bridge.
    *   If both ends of a segment have the same cost to the Root Bridge, the switch with the lowerBridge ID becomes the Designated Bridge, and its port becomes the Designated Port.
    *   All Designated Ports are in a forwarding state.

5.  **Blocked Port (Alternate Port):**
    *   Any port that is not a Root Port or a Designated Port becomes a **Blocked Port** (also called an Alternate Port).
    *   Blocked ports do not forward user traffic, thus preventing loops. They still listen for BPDUs to detect topology changes.

6.  **STP Port States:**
    *   **Blocking:** Does not forward user data, only listens to BPDUs. Prevents loops. (Initial state for most ports).
    *   **Listening:** Listens to BPDUs, processes them, and participates in STP election. Does not forward user data.
    *   **Learning:** Listens to BPDUs, processes them, and learns MAC addresses to populate the MAC address table. Does not forward user data.
    *   **Forwarding:** Forwards user data, sends and receives BPDUs, and learns MAC addresses. (Root Ports and Designated Ports).
    *   **Disabled:** Administratively shut down.

7.  **Convergence:**
    *   The process by which all switches in the network agree on the STP topology (Root Bridge, Root Ports, Designated Ports, Blocked Ports).
    *   When a topology change occurs (e.g., a link goes down or comes up), STP recalculates the tree, and ports transition through the listening and learning states before entering forwarding or blocking. This convergence process can take 30-50 seconds with traditional STP.

**Variations of STP:**

*   **RSTP (Rapid Spanning Tree Protocol - IEEE 802.1w):** An evolution of STP that significantly speeds up convergence times (typically within a few seconds) by introducing new port roles and faster transition mechanisms.
*   **MSTP (Multiple Spanning Tree Protocol - IEEE 802.1s):** Allows for multiple STP instances to run concurrently, mapping different VLANs to different spanning trees. This enables load balancing and more efficient use of redundant paths.
*   **PVST+/RPVST+ (Per-VLAN Spanning Tree Plus / Rapid Per-VLAN Spanning Tree Plus):** Cisco proprietary versions that run a separate STP instance for each VLAN, allowing for more granular control over traffic flow.

**Importance in Security:** STP is crucial for network stability, which indirectly impacts security. A stable network is less susceptible to denial-of-service attacks caused by loops. Attackers might try to manipulate STP (e.g., by introducing a rogue switch with a lower priority) to become the Root Bridge, potentially redirecting traffic through their device for eavesdropping or manipulation. Proper STP configuration and security features (like BPDU Guard and Root Guard) are essential to prevent such attacks.

======================================================================================================================================================

--> VLANs (virtual local area networks) and 802.1Q Tagging :-VLANs (Virtual Local Area Networks) are a logical grouping of network devices that appear to be on the same local area network (LAN) even if they are geographically separated. They allow network administrators to segment a single physical network into multiple logical broadcast domains.

Why are VLANs needed?

1.  **Broadcast Domain Segmentation:** Reduces the size of broadcast domains, which improves network performance by limiting the scope of broadcast traffic (like ARP requests).
2.  **Security:** Isolates sensitive data or departments from other parts of the network. Devices in one VLAN cannot directly communicate with devices in another VLAN without a Layer 3 device (router or Layer 3 switch).
3.  **Flexibility and Scalability:** Allows for easier network reorganization and expansion without physically re-cabling. Users can be moved to different physical locations but remain in the same logical VLAN.
4.  **Management:** Simplifies network management by grouping users or devices with similar requirements.

How VLANs Work:

*   **VLAN ID:** Each VLAN is assigned a unique identifier, typically a number between 1 and 4094 (e.g., VLAN 10 for Sales, VLAN 20 for HR).
*   **Port Assignment:** Switch ports are assigned to specific VLANs. A device connected to a port assigned to VLAN 10 will only communicate with other devices in VLAN 10 on that switch (or other switches if configured correctly).
*   **Trunk Links:** To allow devices in the same VLAN but on different physical switches to communicate, "trunk links" are used. A trunk link is a single physical link that carries traffic for multiple VLANs.

**802.1Q Tagging (VLAN Tagging):**

When multiple VLANs share a single physical link (a trunk link), a mechanism is needed to identify which VLAN each frame belongs to. This is where IEEE 802.1Q (often just called "dot1q") tagging comes in.

*   **Description:** 802.1Q is the IEEE standard for VLAN tagging on Ethernet frames. It inserts a small 4-byte tag into the Ethernet frame header.
*   **How it Works:**
    1.  When a frame from a specific VLAN (e.g., VLAN 10) needs to be sent across a trunk link, the sending switch inserts an 802.1Q tag into the Ethernetframe. This tag contains the VLAN ID.
    2.  The frame travels across the trunk link to the receiving switch.
    3.  The receiving switch reads the 802.1Q tag to identify which VLAN the frame belongs to.
    4.  The tag is then removed, and the frame is forwarded to the appropriate port(s) within that VLAN.

*   **Untagged vs. Tagged Ports:**
    *   **Access Ports (Untagged):** These ports are typically connected to end devices (computers, printers). They belong to a single VLAN, and frames leaving or entering these ports are *not* tagged with 802.1Q headers. The switch implicitly knows the VLAN based on the port's configuration.
    *   **Trunk Ports (Tagged):** These ports are used to connect switches to other switches or to routers. They carry traffic for multiple VLANs, and all frames (except for the native VLAN, if configured) traversing these ports are *tagged* with their respective VLAN IDs using 802.1Q.

*   **Native VLAN:** On a trunk port, one VLAN can be designated as the "native VLAN." Frames belonging to the native VLAN are typically sent *untagged* over the trunk link. Both ends of the trunk must agree on the native VLAN for proper communication.

**VLAN Hopping Attacks:**
*   **Description:** A type of network attack where an attacker on one VLAN gains access to another VLAN.
*   **Methods:**
    *   **Switch Spoofing:** The attacker's device pretends to be a trunking switch, tricking the legitimate switch into forming a trunk link. This allows the attacker to send and receive traffic for all VLANs.
    *   **Double Tagging (VLAN Tag Stacking):** The attacker crafts a frame with two 802.1Q tags. The outer tag is for the native VLAN, which is stripped by the first switch. The inner tag, intended for a target VLAN, is then exposed and processed by the second switch, allowing the frame to reach the target VLAN.
*   **Mitigation:** Disable DTP (Dynamic Trunking Protocol) on access ports, explicitly configure trunk ports, change the native VLAN from VLAN 1, and ensure the native VLAN is not used for user traffic.

======================================================================================================================================================

--------------------------------------------------------       DAY 2 Ends Here        ----------------------------------------------------------------